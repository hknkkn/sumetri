
<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>Sumetri - harita demo</title>
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.js"></script>
	<script type='text/javascript' src="https://cdnjs.cloudflare.com/ajax/libs/ol3/3.6.0/ol-debug.js"></script>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/ol3/3.6.0/ol.css">
	<style type='text/css'>
		
	</style>
	

</head>
<body>
	<div class="row-fluid">
		<div class="span12">
			<div id="map" class="map"></div>
		</div>
	</div>

	<form id="options-form" automplete="off">
		<div class="radio">
			<label><input type="radio" name="interaction" value="draw" id="draw" checked=""/>Ciz &nbsp;</label>
		</div>
		<div class="radio">
			<label><input type="radio" name="interaction" value="modify"/>Duzenele&nbsp;</label>
		</div>
		<div class="form-group">
			<label>Cizim turu&nbsp;</label>
			<select name="draw-type" id="draw-type">
				<option value="Point">Nokta</option>
				<option value="LineString">Cizgi</option>
				<option value="Polygon">Kosegen</option>
			</select>
		</div>
	</form>

<script type='text/javascript'>//<![CDATA[ 

//http://openlayers.org/en/v3.3.0/examples/vector-labels.html


//$(window).load(function(){
var raster = new ol.layer.Tile({
	source: new ol.source.MapQuest({layer: 'sat'})
});

var vectorStyle = new ol.style.Style({
	fill: new ol.style.Fill({
		color: 'rgba(255, 255, 255, 0.2)'
	}),
	stroke: new ol.style.Stroke({
		color: '#ffcc33',
		width: 2
	}),
	image: new ol.style.Circle({
		radius: 7,
		fill: new ol.style.Fill({
			color: '#ffcc33'
		})
	})
});

var vector = new ol.layer.Vector({
	source: new ol.source.Vector(),
	style: vectorStyle
});

var map = new ol.Map({
	layers: [raster, vector],
	target: 'map',
	view: new ol.View({
		center: [-11000000, 4600000],
		zoom: 13
	}),
	controls: ol.control.defaults().extend([
		new ol.control.ScaleLine()
	])
});

var Modify = {
	init: function() {
		this.select = new ol.interaction.Select();
		map.addInteraction(this.select);

		this.modify = new ol.interaction.Modify({
			features: this.select.getFeatures()
		});
		map.addInteraction(this.modify);

		this.setEvents();
	},
	setEvents: function() {
		var selectedFeatures = this.select.getFeatures();

		this.select.on('change:active', function() {
			selectedFeatures.forEach(selectedFeatures.remove, selectedFeatures);
		});
	},
	setActive: function(active) {
		this.select.setActive(active);
		this.modify.setActive(active);
	}
};
Modify.init();


var Draw = {
	init: function() {
		map.addInteraction(this.Point);
		this.Point.setActive(false);
		map.addInteraction(this.LineString);
		this.LineString.setActive(false);
		map.addInteraction(this.Polygon);
		this.Polygon.setActive(false);
		this.Polygon.on('drawend', function(e) {
			e.feature.setStyle(new ol.style.Style({
				fill: vector.getStyle().getFill(),
				stroke: vector.getStyle().getStroke(),
				image: vector.getStyle().getImage(),
				text: new ol.style.Text({
					font: "Monospace",
					scale: 2,
					fill: new ol.style.Fill({
						color: 'rgba(255, 128, 128, 0.9)'
					}),
					stroke: new ol.style.Stroke({
						color: '#ffffff',
						width: 1
					}),
					text: window.prompt("Alan adi")
				})
			}));
			return e.feature;
		});
	},
	Point: new ol.interaction.Draw({
		source: vector.getSource(),
		type: /** @type {ol.geom.GeometryType} */ ('Point')
	}),
	LineString: new ol.interaction.Draw({
		source: vector.getSource(),
		type: /** @type {ol.geom.GeometryType} */ ('LineString')
	}),
	Polygon: new ol.interaction.Draw({
		source: vector.getSource(),
		type: /** @type {ol.geom.GeometryType} */ ('Polygon')
	}),
	getActive: function() {
		return this.activeType ? this[this.activeType].getActive() : false;
	},
	setActive: function(active) {
		var type = optionsForm.elements['draw-type'].value;
		if (active) {
			this.activeType && this[this.activeType].setActive(false);
			this[type].setActive(true);
			this.activeType = type;
		} else {
			this.activeType && this[this.activeType].setActive(false);
			this.activeType = null;
		}
	}
};
Draw.init();

var optionsForm = document.getElementById('options-form');


/**
 * Let user change the geometry type.
 * @param {Event} e Change event.
 */
optionsForm.onchange = function(e) {
	var type = e.target.getAttribute('name');
	var value = e.target.value;
	if (type == 'draw-type') {
		Draw.getActive() && Draw.setActive(true);
	} else if (type == 'interaction') {
		if (value == 'modify') {
			Draw.setActive(false);
			Modify.setActive(true);
		} else if (value == 'draw') {
			Draw.setActive(true);
			Modify.setActive(false);
		}
	}
};

Draw.setActive(true);
Modify.setActive(false);

// The snap interaction must be added after the Modify and Draw interactions
// in order for its map browser event handlers to be fired first. Its handlers
// are responsible of doing the snapping.
var snap = new ol.interaction.Snap({
	source: vector.getSource()
});
map.addInteraction(snap);

//});//]]>	

</script>



</body>

</html>

